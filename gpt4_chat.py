import json
from gpt4free.forefront import ForeFrontResponse, Completion
from typing import List, Dict

def chat_with_gpt4(user_input: str, conversation_history: List[Dict], token: str) -> str:
    # 将用户输入和历史消息添加到提示中
    prompt = "".join([f"{message['role']}: {message['content']}\n" for message in conversation_history])
    prompt += f"user: {user_input}\nassistant:"

    # 使用 GPT-4 API 发送请求并获取响应
    response = Completion.create(
        token=token,
        prompt=prompt,
        model="gpt-4"
    )

    # 从响应中提取并返回答案
    answer = response.text.strip()
    return answer

user_input = "What is the capital of France?"
conversation_history = []

your_token = "eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0..O-tMU3LLnmUxGUhq.bn2PmAMDAcpSag012E33FEIQ5HW6kiub3LpdU79LLb-Fk2NPPT3VP95IOKqL9Vx1MBYabPRSSuKCfwGFAs86RtiQDbKSwHq_oeZN_XI6lhbU9wnwJc9map8xz2DrykpZErmCt2Iz8ifNFLbqW_dezzVjWmmB-yeJNlvqAUhitPkUhE1F6KjMZRZz6VD6wqiiE0QeoOC52HZCK3zfMDxQumLwOJ1VxHtThm1cNFSphaGOVKN1zi8GinHWLrU-B2NpQa7ON9A80BbjZivzatUazJFpyq-eguomV3NIUhsNt9_6HGY1DXvfyfTejujvtYrSkTDxNtKwbETPvtMd2v-AtpTjc6sgQG_umZNVIolqqAFcKaQW_-97ot87QW2WzLUK4i3XVCv3fklXqDxEIw-dTMerH-CuM8IYIF6Va2rk58XUsGQIVWdhrViyNeQ3RUekTizmavcb5BgV8wAVOFUzhyfnqyDzBLPZsIEeXgmTajPpYfyIgJgVjW2TUR_b1kiYZ3bQLXQQGgk49hIo4NruJ0QcxjCPy4lNua9Pe3Zg4oFTTpFBndO8a93TJOU_gG1slBdRnG2kg_Z0dr1_mO0SlCEceRg9QNd5ozcko-8DIjudjZvO37WubPJ1uivGmqmIkRr2LDcxQ5xxLrFPPglYexysrEPj_bKZASEtkiyulCoGdWY3CI3j8hSd1EexHXHfSWcta35kqz5_z72pf5MMwOC4dwoHaGdC-MIIp0YiZJWXsVwqnpH-JqdCc7tHHbvPdBqxm2eEZPbbPPBuJpYojHwE2O44MQwdSCLHuvbrr9wi2h_oGID3qZ4Yg8GliIMHjRWDMkXmKtEk8BwvnhCcplsaujCewnJoplvS9RKOUjRcMcTOxWkoRBKK-jqsHsiLLSt6fGukCqwdVb5vFWBLeP_MSI0-FwiBP8HiP2wEFOLzVJzld_X0d09n-esBHGNkFe78E2YZgmiENmF2cuM9u4dtmJR2WhW9tauMftU1zCYS1E5Wjso5PBB1PEFgjbwFk42XzSMvgcQMD1ua-nwdLt3F0xaq8rJGPkvhBAP5JdxLbQums0f8NqBgj0n3KV5F1HDNbVAVZXa48nz7xx3POze791LLSTQrfKobd20zeacsKfUd1FKq7KYNfls0iryOHGZq6o_h8suGOWVENr40Ivbjmyy3Pp5I-8oQA37ZEeVgue1eg8bIs-EKFnn6rX_EhGoBGyJ85fbvZc65tOlWbKtnXXAz29ySy_UMSetK2J2KD2vZXL_fu79uUANN_m0pmFywYOx2VLQ3wubBL8WuA8dhdRrp95SL7Qwo2lfLwY0bH2IjxVo-Foi0u7OH1JEf6jdTD5vjRTbVj9G5-3HqiW0fSgX8ARI_FrmvpgRLeeGg1jfLj5HWpBzY6kpqsVB8T7KeJ8IuY3Y3umXNka6j6x82LV_8UwkWQz7ZapFB8gFVzFYjGTkiq1iIe6S-uJOm-jOm-Ah5kDHPOcJEVouQxUIVZMcibraPCkqtulU9HGKC6YPGzzJtnZwTPxg9KNOwuJUJHePspdvvp7HOzFo00qsO_iKV4163eZ6qJHDHx9Lfb2uzzOmxUv7JqQMQfxmymwwsMGnVzFbIqs_UfaqCiuIB8Lt7PPY9qQQUqj5MNLZOyQ_HAUns5lX9DkdkrRvtyycOB4h8PAM3YGn24fxceMSA3C4m_PvnxYvzr-nPTvM8NXbcOWoQdXHb-uPs9-cV-BKNPmbhVMFKBq4O-ZjNDKWdrHVFqqwdDIyunKI-IsQJQuWjDHCPpkfoQoLT8tsyBtWn4g6w3KUlelDQ3QJgq97_adf6SIxVmOfvzSnQxYqFuB1uX8X_8ndeKpQ0V34Re0_FAu0Nxq08gdze0bLHZai4oaduvaP5G6pkH_lMbAcTyqntIsxf4lCNN2bcUNmTDO8_QfQ5VNxXDyBfPHB0TgX4C3xIxDKccpygqw0RN2xODx9eb_aR2rRei2g3r0cgzZOpvjPqjDeVLrNJdqIVmfZq51RkrkbMA3BYs7LyQWN1x-4mtYGbxzgEst7i0g70a-VGrP211K-t4rZShCD77z-hmNVnnmhoupiNEsB59zMEaeZJ569fT5BO3lT1ZB7qmiMMr24Hlrs3VRq9eElSfytCEHGr-F4GFPLsTb27-oe34FX8Ct92xaTGof5UmAyEHwPw1J-bQVeVQv38NSVK2WIeTHGkNJrFGG18buAYFhkiihCDmelrBlcknj7xchQPTMva6Hq9nAMqNLlwKnLxs9m_yfAkGp8BG2u9TqTQv4vzkLLunsADaq2NdXuj_YrZx-H5pKPUgiW-yY1O_nOgwyB6dPvM9w6dxXLNn713j3Sjj-XBE0uhoUU9n8LKvbBsIM9HOOO3ALwIthOT6FVYhlHzpeF9CqVY0VzQyo2U05RUuc3WquyLn9EvnkRwesW7A90L0fMsv5ECbDwBUGUbKkDBJoI_11QgLeO6GgeGc6G6F76wPjuCxTgVJtmiys-VhQGbIBKpggfjrXngGEIkgeU6ZajVMZZ37DhGl__bari28nP6-OibVWF7p4n2YNGn0Gwg9XgtpVpj2NG-FuM12sv02VRDoT44eK9Fyep-7hmX5v2YOTXprTz4C-xn9ICVgWccdQ0NSi2yfwPYXfQq4BCNn-7r_WeZxSYByaposcezQstndYq2J6IRycF60zrQlUGARaCMDsa2UO24toiia54X_Gm0LveFSuFvjjDV4FZJ4PWi3RsWcZj8Ll8TySwc492FDw0ia9hoDRNB5FozCRsKn9n785niQ67u.sXQveainl-0jx8CFgHVCww"  # 使用从浏览器获取到的令牌替换
answer = chat_with_gpt4(user_input, conversation_history, your_token)
print(answer)